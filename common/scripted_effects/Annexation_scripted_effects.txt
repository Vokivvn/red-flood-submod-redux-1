occupy_small_country = {
	add_political_power = -25
	add_stability = -0.025
	add_war_support = -0.025
	recheck_annexations = yes
}

occupy_medium_country = {
	add_political_power = -50
	add_stability = -0.05
	add_war_support = -0.05
	recheck_annexations = yes
}

occupy_large_country = {
	add_political_power = -100
	add_stability = -0.1
	add_war_support = -0.1
	recheck_annexations = yes
}

occupy_huge_country = {
	add_political_power = -150
	add_stability = -0.15
	add_war_support = -0.15
	recheck_annexations = yes
}

occupy_massive_country = {
	add_political_power = -200
	add_stability = -0.2
	add_war_support = -0.2
	recheck_annexations = yes
}

# state scope
transfer_state_and_add_core = {
	remove_claim_and_add_core_of_target = yes
	transfer_state_without_overriding_occupation = yes
}

# state scope
transfer_state_and_add_claim = {
	remove_claim_and_add_claim_of_target = yes
	var:tag_to_release = { transfer_state = PREV }
}

# state scope
remove_claim_and_add_core_of_target = {
	if = {
		limit = { is_claimed_by = var:tag_to_release }
		remove_claim_by = var:tag_to_release
	}
	if = {
		limit = { NOT = { is_core_of = var:tag_to_release } }
		add_core_of = var:tag_to_release
	}
}

# state scope
remove_claim_and_add_claim_of_target = {
	if = {
		limit = {
			NOT = {
				is_claimed_by = var:tag_to_release
				is_core_of = var:tag_to_release
			}
		}
		add_claim_by = var:tag_to_release
	}
}

# state scope
transfer_state_without_overriding_occupation = {
	if = {
		limit = { is_fully_controlled_by = owner }
		transfer_state_to = var:tag_to_release
	}
	else = {
		set_state_owner_to = var:tag_to_release
		set_state_province_controller = {
			controller = var:tag_to_release
			limit = { NOT = { has_war_with = ROOT } }
		}
	}
}

# global scope
remove_all_cores_and_claims_of_tags = {
	every_state = {
		limit = {
			any_of = {
				array = core_removal_array
				OR = {
					is_core_of = var:v
					is_claimed_by = var:v
				}
			}
		}
		for_each_loop = {
			array = core_removal_array
			remove_core_of = var:v
			remove_claim_by = var:v
		}
	}
}

# global scope
transfer_territory_from_core_regions = {
	every_owned_state = {
		limit = {
			any_of = {
				array = target_cores_to_release
				is_core_of = var:v
			}
			is_claim_or_core_of_ROOT = no
		}
		var:tag_to_release = { transfer_state = PREV }
	}
	recheck_annexations = yes
}

# global scope
transfer_territory_from_core_regions_and_add_cores = {
	every_owned_state = {
		limit = {
			any_of = {
				array = target_cores_to_release
				is_core_of = var:v
			}
			is_claim_or_core_of_ROOT = no
		}
		var:tag_to_release = {
			add_state_core = PREV
			transfer_state = PREV
		}
	}
	recheck_annexations = yes
}

# global scope
release_targeted_tag_from_core_regions = {
	transfer_territory_from_core_regions = yes
	puppet_released_tag = yes
}

# global scope
release_targeted_tag_from_core_regions_and_add_cores = {
	transfer_territory_from_core_regions_and_add_cores = yes
	puppet_released_tag = yes
}

# global scope
release_targeted_tag_with_claims = {
	every_owned_state = {
		limit = {
			OR = {
				is_core_of = var:tag_to_release
				AND = {
					is_claimed_by = var:tag_to_release
					#is_clear_other_claims = yes
				}
			}
			is_claim_or_core_of_ROOT = no
		}
		var:tag_to_release = { transfer_state = PREV }
	}
	puppet_released_tag = yes
}

# global scope
release_targeted_tag_during_war = {
	every_owned_state = {
		limit = {
			is_core_of = var:tag_to_release
			is_claim_or_core_of_ROOT = no
		}
		if = {
			limit = {
				is_fully_controlled_by = controller
				controller = { is_ally_with = ROOT }
			}
			var:tag_to_release = { transfer_state = PREV }
		}
		else = {
			var:tag_to_release = { set_state_owner = PREV }
		}
	}
	puppet_released_tag = yes
}

# state scope
transfer_to_ROOT = {
	if = {
		limit = {
			is_fully_controlled_by = controller
			controller = { is_ally_with = ROOT }
		}
		ROOT = { transfer_state = PREV }
	}
	else = {
		ROOT = { set_state_owner = PREV }
	}
}

# country_scope, with PREV as the state
transfer_PREV_to_THIS = {
	if = {
		limit = {
			PREV = {
				is_fully_controlled_by = controller
				controller = { is_ally_with = PREV.PREV }
			}
		}
		transfer_state = PREV
	}
	else = {
		set_state_owner = PREV
	}
}

# global scope
release_targeted_tag = {
	hidden_effect = {
		var:tag_to_release = {
			if = {
				limit = { has_country_flag = was_puppeted }
				kill_country_leader = yes
			}
		}
	}
	var:tag_to_release = {
		drop_cosmetic_tag = yes
		#accelerationist_socialist_government_change = yes
		mark_focus_tree_layout_dirty = yes
		load_focus_tree = { tree = generic_focus }
		set_country_flag = {
			flag = remove_idea
			days = 7
		}
		inherit_technology = ROOT
		
		#remove_all_minister_types = yes
		#hidden_effect = { set_puppet_minister = yes }
		#custom_effect_tooltip = general_minister_change_tt
	}
}

# global scope
puppet_released_tag = {
	hidden_effect = {
		var:tag_to_release = {
			if = {
				limit = { has_country_flag = was_puppeted }
				kill_country_leader = yes
			}
		}
	}
	puppet = var:tag_to_release
	var:tag_to_release = {
		drop_cosmetic_tag = yes
		#accelerationist_socialist_government_change = yes
		mark_focus_tree_layout_dirty = yes
		load_focus_tree = { tree = generic_focus }
		set_country_flag = {
			flag = remove_idea
			days = 7
		}
		inherit_technology = ROOT
		
		#remove_all_minister_types = yes
		#hidden_effect = { set_puppet_minister = yes }
		#custom_effect_tooltip = general_minister_change_tt
	}
	if = {
		limit = {
			ROOT = {
				has_country_flag = RF_omit_default_puppeting
			}
		}
		if = {
			limit = {
				ROOT = {
					original_tag = KAV
					NOT = {
						has_country_leader = {
							character = KAV_igor_severyanin
						}
					}
				}
			}
			var:tag_to_release = {
				set_country_leader_ideology = vperedism
			}
		}
	}
	else = {
		if = {
			limit = {
				ROOT = { has_country_leader_ideology = futurism }
			}
			var:tag_to_release = {
				set_country_leader_ideology = futurism
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = national_rejuvenatism }
			}
			var:tag_to_release = {
				set_country_leader_ideology = national_rejuvenatism
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = technocracy }
			}
			var:tag_to_release = {
				set_country_leader_ideology = technocracy
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = vperedism }
			}
			var:tag_to_release = {
				set_country_leader_ideology = vperedism
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = surrealism }
			}
			var:tag_to_release = {
				set_country_leader_ideology = surrealism
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = fiumanism }
			}
			var:tag_to_release = {
				set_country_leader_ideology = fiumanism
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = social_anarchism }
			}
			var:tag_to_release = {
				set_country_leader_ideology = social_anarchism
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = individualist_anarchism }
			}
			var:tag_to_release = {
				set_country_leader_ideology = individualist_anarchism
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = mystical_anarchism }
			}
			var:tag_to_release = {
				set_country_leader_ideology = mystical_anarchism
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = stratocratic_anarchism }
			}
			var:tag_to_release = {
				set_country_leader_ideology = stratocratic_anarchism
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = national_anarchism }
			}
			var:tag_to_release = {
				set_country_leader_ideology = national_anarchism
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = leninism }
			}
			var:tag_to_release = {
				set_country_leader_ideology = leninism
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = national_vanguardism }
			}
			var:tag_to_release = {
				set_country_leader_ideology = national_vanguardism
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = state_socialism }
			}
			var:tag_to_release = {
				set_country_leader_ideology = state_socialism
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = social_republicanism }
			}
			var:tag_to_release = {
				set_country_leader_ideology = social_republicanism
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = stratocratic_socialism }
			}
			var:tag_to_release = {
				set_country_leader_ideology = stratocratic_socialism
			}
		}
		else_if = {
			limit = {
				ROOT = {
					has_country_leader_ideology = spartakism
					
				}
			}
			var:tag_to_release = {
				set_country_leader_ideology = spartakism
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = syndicalism }
			}
			var:tag_to_release = {
				set_country_leader_ideology = syndicalism
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = folk_socialism }
			}
			var:tag_to_release = {
				set_country_leader_ideology = folk_socialism
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = national_syndicalism }
			}
			var:tag_to_release = {
				set_country_leader_ideology = national_syndicalism
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = democratic_socialism }
			}
			var:tag_to_release = {
				set_country_leader_ideology = democratic_socialism
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = religious_socialism }
			}
			var:tag_to_release = {
				set_country_leader_ideology = religious_socialism
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = agrarian_socialism }
			}
			var:tag_to_release = {
				set_country_leader_ideology = agrarian_socialism
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = utopian_socialism }
			}
			var:tag_to_release = {
				set_country_leader_ideology = utopian_socialism
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = esoteric_socialism }
			}
			var:tag_to_release = {
				set_country_leader_ideology = esoteric_socialism
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = progressive_democracy }
			}
			var:tag_to_release = {
				set_country_leader_ideology = progressive_democracy
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = left_populism }
			}
			var:tag_to_release = {
				set_country_leader_ideology = left_populism
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = social_nationalism }
			}
			var:tag_to_release = {
				set_country_leader_ideology = social_nationalism
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = liberal_socialism }
			}
			var:tag_to_release = {
				set_country_leader_ideology = liberal_socialism
			}
		}
		else_if = {
			limit = {
				ROOT = {
					has_country_leader_ideology = progressive_corporatism }
			}
			var:tag_to_release = {
				set_country_leader_ideology = progressive_corporatism
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = social_liberalism }
			}
			var:tag_to_release = {
				set_country_leader_ideology = social_liberalism
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = classical_liberalism }
			}
			var:tag_to_release = {
				set_country_leader_ideology = classical_liberalism
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = libertarian_capitalism }
			}
			var:tag_to_release = {
				set_country_leader_ideology = libertarian_capitalism
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = national_liberalism }
			}
			var:tag_to_release = {
				set_country_leader_ideology = national_liberalism
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = social_conservatism }
			}
			var:tag_to_release = {
				set_country_leader_ideology = social_conservatism
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = liberal_conservatism }
			}
			var:tag_to_release = {
				set_country_leader_ideology = liberal_conservatism
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = national_conservatism }
			}
			var:tag_to_release = {
				set_country_leader_ideology = national_conservatism
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = right_populism }
			}
			var:tag_to_release = {
				set_country_leader_ideology = right_populism
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = anocracy }
			}
			var:tag_to_release = {
				set_country_leader_ideology = anocracy
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = oligarchy }
			}
			var:tag_to_release = {
				set_country_leader_ideology = oligarchy
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = praetorian_oligarchy }
			}
			var:tag_to_release = {
				set_country_leader_ideology = praetorian_oligarchy
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = plutocracy }
			}
			var:tag_to_release = {
				set_country_leader_ideology = plutocracy
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = national_democracy }
			}
			var:tag_to_release = {
				set_country_leader_ideology = national_democracy
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = absolute_monarchy }
			}
			var:tag_to_release = {
				set_country_leader_ideology = absolute_monarchy
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = constitutional_monarchy }
			}
			var:tag_to_release = {
				set_country_leader_ideology = constitutional_monarchy
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = constitutional_dictatorship }
			}
			var:tag_to_release = {
				set_country_leader_ideology = constitutional_dictatorship
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = military_dictatorship }
			}
			var:tag_to_release = {
				set_country_leader_ideology = military_dictatorship
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = theocracy }
			}
			var:tag_to_release = {
				set_country_leader_ideology = theocracy
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = personalist_dictatorship }
			}
			var:tag_to_release = {
				set_country_leader_ideology = personalist_dictatorship
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = revolutionary_nationalism }
			}
			var:tag_to_release = {
				set_country_leader_ideology = revolutionary_nationalism
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = reactionary_populism }
			}
			var:tag_to_release = {
				set_country_leader_ideology = reactionary_populism
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = religious_fundamentalism }
			}
			var:tag_to_release = {
				set_country_leader_ideology = religious_fundamentalism
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = esoteric_reactionism }
			}
			var:tag_to_release = {
				set_country_leader_ideology = esoteric_reactionism
			}
		}
		else_if = {
			limit = {
				ROOT = { has_country_leader_ideology = aristocratic_reaction }
			}
			var:tag_to_release = {
				set_country_leader_ideology = aristocratic_reaction
			}
		}
	}

	recheck_annexations = yes
}

# global scope
puppet_released_tag_nocosmetic = {
	hidden_effect = {
		var:tag_to_release = {
			if = {
				limit = { has_country_flag = was_puppeted }
				kill_country_leader = yes
			}
		}
	}
	puppet = var:tag_to_release
	var:tag_to_release = {
		drop_cosmetic_tag = yes
		mark_focus_tree_layout_dirty = yes
		load_focus_tree = {
			tree = generic_focus
		}
		set_country_flag = {
			flag = remove_idea
			days = 7
		}
		inherit_technology = ROOT
		#remove_all_minister_types = yes
		#hidden_effect = { set_puppet_minister = yes }
		#custom_effect_tooltip = general_minister_change_tt
	}
	recheck_annexations = yes
}
